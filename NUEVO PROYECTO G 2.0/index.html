<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Universo 3D</title>
  <style>
    body { margin:0; overflow:hidden; background:black; }
    canvas { display:block; }
  </style>
</head>
<body>

<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js';
import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/controls/OrbitControls.js';

let scene, camera, renderer, controls;
let planetas = [];
let lunaTexture, nebulaTexture;
const nombre = "GERAL";

function init(){
  scene = new THREE.Scene();

  camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 5000);
  camera.position.set(0,200,600);

  renderer = new THREE.WebGLRenderer({ antialias:true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.body.appendChild(renderer.domElement);

  controls = new OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  controls.dampingFactor = 0.05;

  // Luces
  scene.add(new THREE.AmbientLight(0xffffff,0.3));
  const dirLight = new THREE.DirectionalLight(0xffffff,1);
  dirLight.position.set(200,500,300);
  scene.add(dirLight);

  // Fondo nebulosa
  const loader = new THREE.TextureLoader();
  nebulaTexture = loader.load('nebulosa.jpg'); 
  scene.background = nebulaTexture;

  // Textura de la luna
  lunaTexture = loader.load('luna.jpg'); 

  // Planetas
  const planetConfig = [
    { src:'marte.jpg', size:30, distance:140, speed:0.01, lunas:1 },
    { src:'tierra.jpg', size:40, distance:240, speed:0.008, lunas:1 },
    { src:'jupiter.jpg', size:65, distance:380, speed:0.006, lunas:2 },
    { src:'saturno.jpg', size:75, distance:540, speed:0.004, lunas:3 }
  ];

  planetConfig.forEach(cfg=>{
    const texture = loader.load(cfg.src);
    const geometry = new THREE.SphereGeometry(cfg.size, 64, 64);
    const material = new THREE.MeshStandardMaterial({ map: texture });
    const planet = new THREE.Mesh(geometry, material);

    // Órbita
    const orbit = new THREE.Object3D();
    orbit.add(planet);
    planet.position.set(cfg.distance,0,0);

    // Lunas
    const lunas = [];
    for(let i=0;i<cfg.lunas;i++){
      const lunaGeo = new THREE.SphereGeometry(6,32,32);
      const lunaMat = new THREE.MeshStandardMaterial({ map: lunaTexture });
      const lunaMesh = new THREE.Mesh(lunaGeo, lunaMat);
      const lunaOrbit = new THREE.Object3D();
      lunaOrbit.add(lunaMesh);
      lunaMesh.position.set(12 + i*18,0,0);
      planet.add(lunaOrbit);
      lunas.push({ mesh:lunaMesh, orbit:lunaOrbit, speed:0.02 + i*0.01 });
    }

    planetas.push({ mesh:planet, orbit, speed:cfg.speed, lunas });
    scene.add(orbit);
  });

  window.addEventListener('resize', onWindowResize);
  animate();
}

function onWindowResize(){
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
}

function animate(){
  requestAnimationFrame(animate);

  // Rotación planetas y lunas
  planetas.forEach(p=>{
    p.orbit.rotation.y += p.speed;
    p.lunas.forEach(l=> l.orbit.rotation.y += l.speed);
  });

  controls.update();
  renderer.render(scene,camera);
}

init();
</script>

</body>
</html>
